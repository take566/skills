# セキュリティチェック

このリポジトリでは、GitHub Actionsを使用して自動的にセキュリティスキャンを実行します。

## 実装されているセキュリティチェック

### 1. CodeQL分析
- **目的**: コードの脆弱性とセキュリティの問題を検出
- **対象**: Pythonコード
- **実行タイミング**: プッシュ、プルリクエスト、毎日定期実行
- **カバレッジ**: セキュリティとコード品質のクエリ

### 2. Banditスキャン
- **目的**: Python特有のセキュリティ問題を検出
- **検出内容**:
  - ハードコードされた認証情報
  - SQLインジェクション
  - 安全でない暗号化の使用
  - パストラバーサルの脆弱性
- **実行タイミング**: プッシュ、プルリクエスト、毎日定期実行

### 3. 依存関係の脆弱性スキャン
- **目的**: 使用している外部ライブラリの既知の脆弱性を検出
- **ツール**: Safety
- **実行タイミング**: プッシュ、プルリクエスト、毎日定期実行

### 4. シークレット検出
- **目的**: リポジトリ内のAPIキーや認証情報の漏洩を防止
- **ツール**: Gitleaks
- **実行タイミング**: プッシュ、プルリクエスト、毎日定期実行

### 5. YAML構文チェック
- **目的**: 設定ファイルの構文エラーやセキュリティ問題を検出
- **ツール**: yamllint
- **実行タイミング**: プッシュ、プルリクエスト、毎日定期実行

## ワークフローファイル

`.github/workflows/security-scan.yml`に全てのセキュリティチェックが定義されています。

## スキャン結果の確認方法

### GitHubアクション
1. リポジトリのActionsタブを開く
2. "Security Scan"ワークフローを選択
3. 最新の実行結果を確認

### セキュリティタブ
1. リポジトリのSecurityタブを開く
2. "Code scanning alerts"でCodeQLの結果を確認
3. "Secret scanning alerts"でシークレット検出の結果を確認

## ローカルでのセキュリティチェック実行

### Banditの実行
```bash
pip install bandit
bandit -r . -f txt
```

### Safetyの実行
```bash
pip install safety
safety check --file requirements.txt
```

### yamllintの実行
```bash
pip install yamllint
find . -type f \( -name "*.yml" -o -name "*.yaml" \) | xargs yamllint
```

## セキュリティ修正の履歴

### 2026-02-09
- ✅ セキュリティスキャンワークフローの追加
- ✅ analyze_pipeline.py: ファイルオープン時に明示的なUTF-8エンコーディングを追加
- ✅ requirements.txtの追加による依存関係の追跡

## セキュリティポリシー

- 全てのプルリクエストはセキュリティチェックを通過する必要があります
- Highレベルの脆弱性は即座に対処する必要があります
- Mediumレベルの脆弱性は次のリリース前に対処します
- Lowレベルの脆弱性は計画的に対処します

## 連絡先

セキュリティ問題を発見した場合は、GitHubのSecurityタブから報告してください。
